{"version":3,"sources":["assets\\scripts\\common\\cmpt\\ui\\scrollList\\VirtualList.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import EditorTool from \"../../../util/EditorTool\";\r\nimport Tool from \"../../../util/Tool\";\r\nimport VirtualLayout from \"./VirtualLayout\";\r\n\r\nconst { ccclass, property, requireComponent, executeInEditMode, disallowMultiple, menu } = cc._decorator;\r\n\r\n/** 主元素模板类型 */\r\nexport enum MainTemplateType {\r\n    NODE,\r\n    PREFAB\r\n}\r\n\r\n/** 副元素模板类型 */\r\nexport enum OtherTemplateType {\r\n    NODE,\r\n    PREFAB,\r\n    MAIN_ITEM_CHILD,\r\n}\r\n\r\n/** 虚拟列表元素参数类型 */\r\nexport interface VirtualArgs { }\r\n\r\n/**\r\n * 虚拟列表主容器\r\n */\r\n@ccclass(\"MainLayoutData\")\r\nexport class MainLayoutData {\r\n    @property({\r\n        type: cc.Node,\r\n        tooltip: CC_DEV && \"列表容器节点\",\r\n        visible() { return false; }\r\n    })\r\n    public content: cc.Node = null;\r\n\r\n    @property({ type: cc.Enum(MainTemplateType) })\r\n    private _templateType: MainTemplateType = MainTemplateType.PREFAB;\r\n    @property({\r\n        type: cc.Enum(MainTemplateType),\r\n        tooltip: CC_DEV && \"列表元素模板类型\"\r\n    })\r\n    public get templateType(): MainTemplateType { return this._templateType; }\r\n    public set templateType(v: MainTemplateType) {\r\n        if (this._templateType === v) {\r\n            return;\r\n        }\r\n        this._templateType = v;\r\n        this.resetMainItemChild(true);\r\n    }\r\n\r\n    @property(cc.Prefab)\r\n    private _templatePrefab: cc.Prefab = null;\r\n    @property({\r\n        type: cc.Prefab,\r\n        tooltip: CC_DEV && \"列表元素模板预制体\",\r\n        visible() { return this.templateType === MainTemplateType.PREFAB; }\r\n    })\r\n    public get templatePrefab(): cc.Prefab { return this._templatePrefab; }\r\n    public set templatePrefab(v: cc.Prefab) {\r\n        if (this._templatePrefab === v) {\r\n            return;\r\n        }\r\n        this._templatePrefab = v;\r\n        this.resetMainItemChild(true);\r\n    }\r\n\r\n    @property(cc.Node)\r\n    private _templateNode: cc.Node = null;\r\n    @property({\r\n        type: cc.Node,\r\n        tooltip: CC_DEV && \"列表元素模板节点\",\r\n        visible() { return this.templateType === MainTemplateType.NODE; }\r\n    })\r\n    public get templateNode(): cc.Node { return this._templateNode; }\r\n    public set templateNode(v: cc.Node) {\r\n        if (this._templateNode === v) {\r\n            return;\r\n        }\r\n        this._templateNode = v;\r\n        this.resetMainItemChild(true);\r\n    }\r\n\r\n    public editorCall: (mainItemChild: unknown, refresh: boolean) => void = null;\r\n\r\n    /**\r\n     * 更新枚举内容\r\n     * @param refresh 是否强制刷新inspector \r\n     * @returns \r\n     */\r\n    public resetMainItemChild(refresh: boolean = false): void {\r\n        if (!CC_EDITOR) {\r\n            return;\r\n        }\r\n        let mainItemChild = {};\r\n        if (this.templateType === MainTemplateType.NODE && this.templateNode) {\r\n            this.templateNode.children.forEach((c, i) => { mainItemChild[c.name] = i; });\r\n        } else if (this.templateType === MainTemplateType.PREFAB && this.templatePrefab) {\r\n            this.templatePrefab.data.children.forEach((c, i) => { mainItemChild[c.name] = i; });\r\n        }\r\n        this.editorCall?.(mainItemChild, refresh);\r\n    }\r\n}\r\n\r\n/**\r\n * 虚拟列表副容器\r\n */\r\n@ccclass(\"OtherLayoutData\")\r\nexport class OtherLayoutData {\r\n    @property({\r\n        type: cc.Node,\r\n        tooltip: CC_DEV && \"列表容器节点\",\r\n    })\r\n    public content: cc.Node = null;\r\n\r\n    @property({\r\n        type: cc.Enum(OtherTemplateType),\r\n        tooltip: CC_DEV && \"列表元素模板类型\"\r\n    })\r\n    public templateType: OtherTemplateType = OtherTemplateType.PREFAB;\r\n\r\n    @property({\r\n        type: cc.Prefab,\r\n        tooltip: CC_DEV && \"列表元素模板预制体\",\r\n        visible() { return this.templateType === OtherTemplateType.PREFAB; }\r\n    })\r\n    public templatePrefab: cc.Prefab = null;\r\n\r\n    @property({\r\n        type: cc.Node,\r\n        tooltip: CC_DEV && \"列表元素模板节点\",\r\n        visible() { return this.templateType === OtherTemplateType.NODE; }\r\n    })\r\n    public templateNode: cc.Node = null;\r\n\r\n    @property({\r\n        type: cc.Enum({}),\r\n        tooltip: CC_DEV && \"以列表主元素的子节点作为模板节点\",\r\n        visible() { return this.templateType === OtherTemplateType.MAIN_ITEM_CHILD; }\r\n    })\r\n    public templateChild: number = -1;\r\n}\r\n\r\n/**\r\n * 虚拟列表\r\n */\r\n@ccclass\r\n@disallowMultiple\r\n@executeInEditMode\r\n@requireComponent(cc.ScrollView)\r\n@menu(\"Framework/UI组件/VirtualList\")\r\nexport default class VirtualList<T extends VirtualArgs> extends cc.Component {\r\n    @property({ type: MainLayoutData, tooltip: CC_DEV && \"列表主容器\" })\r\n    public main: MainLayoutData = new MainLayoutData();\r\n\r\n    @property({ type: OtherLayoutData, tooltip: CC_DEV && \"列表副容器\\n需要分层显示时使用，一般用于降低draw call\" })\r\n    public others: OtherLayoutData[] = [];\r\n\r\n    @property({ tooltip: CC_DEV && \"元素节点大小是否一致\\n大小不一致时必须提供calcItemSize接口，且暂不支持grid排版\" })\r\n    public isFixedSize: boolean = true;\r\n\r\n    private _scrollView: cc.ScrollView = null;\r\n    public get scrollView(): cc.ScrollView {\r\n        if (!this._scrollView) {\r\n            this._scrollView = this.getComponent(cc.ScrollView);\r\n        }\r\n        return this._scrollView;\r\n    }\r\n\r\n    private _layout: VirtualLayout<T> = null;\r\n    public get layout(): VirtualLayout<T> {\r\n        if (!this._layout) {\r\n            this._layout = this.scrollView.content.getComponent(VirtualLayout);\r\n        }\r\n        return this._layout;\r\n    }\r\n\r\n    private _argsArr: T[] = [];\r\n    /** 列表缓存的所有数据 */\r\n    public get argsArr(): T[] { return this._argsArr; }\r\n    public set argsArr(v: T[]) {\r\n        this._argsArr = v;\r\n        this.layout.rearrange();\r\n    }\r\n\r\n    private _calcItemSize: (args: T) => cc.Size = null;\r\n    /** 根据参数计算元素大小的接口（isFixedSize为false时必须提供） */\r\n    public get calcItemSize(): (args: T) => cc.Size { return this._calcItemSize; };\r\n\r\n    protected onLoad(): void {\r\n        if (CC_EDITOR) {\r\n            this.runEditor();\r\n            return;\r\n        }\r\n\r\n        if (this.layout) {\r\n            this.layout.onInit(this);\r\n        }\r\n    }\r\n\r\n    protected resetInEditor(): void {\r\n        this.runEditor();\r\n    }\r\n\r\n    protected onFocusInEditor(): void {\r\n        this.main.resetMainItemChild();\r\n    }\r\n\r\n    /**\r\n     * 编辑器模式下的一些设置\r\n     */\r\n    private runEditor(): void {\r\n        if (!CC_EDITOR) {\r\n            return;\r\n        }\r\n        let scrollView = this.getComponent(cc.ScrollView);\r\n        let layout = scrollView.content.getComponent(VirtualLayout);\r\n        if (!this.main.content) {\r\n            this.main.content = scrollView.content;\r\n        }\r\n        if (!layout) {\r\n            scrollView.content.addComponent(VirtualLayout);\r\n        }\r\n        this.main.editorCall = (mainItemChild: unknown, refresh: boolean): void => {\r\n            let hasChildType = false;\r\n            for (let i = 0; i < this.others.length; i++) {\r\n                if (this.others[i].templateType === OtherTemplateType.MAIN_ITEM_CHILD) {\r\n                    hasChildType = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (hasChildType) {\r\n                EditorTool.setClassAttrPropEnum(OtherLayoutData, \"templateChild\", cc.Enum[\"getList\"](mainItemChild));\r\n                if (refresh) {\r\n                    EditorTool.refreshSelectedInspector(this.node);\r\n                }\r\n            }\r\n        };\r\n        this.main.resetMainItemChild();\r\n    }\r\n\r\n    /**\r\n     * 滚动元素节点到view的指定位置\r\n     * @param idx 元素下标\r\n     * @param itemAnchor 元素的锚点位置（左下角为0点）\r\n     * @param viewAnchor view的锚点位置（左下角为0点）\r\n     * @param t 时间 s\r\n     * @param a 加速度是否衰减，为true且滚动距离大时滚动会不准确\r\n     */\r\n    public scrollItemToView(idx: number, itemAnchor: cc.Vec2 = cc.v2(), viewAnchor: cc.Vec2 = cc.v2(), t: number = 0, a: boolean = true): void {\r\n        this.scrollView.scrollToOffset(this.layout.getScrollOffset(idx, itemAnchor, viewAnchor), t, a);\r\n    }\r\n\r\n    /**\r\n     * 滚动到视图顶部\r\n     */\r\n    public scrollToTop(timeInSecond: number = 0, attenuated: boolean = true): void {\r\n        this.scrollView.scrollToTop(timeInSecond, attenuated);\r\n    }\r\n\r\n    /**\r\n     * 滚动到视图底部\r\n     */\r\n    public scrollToBottom(timeInSecond: number = 0, attenuated: boolean = true): void {\r\n        this.scrollView.scrollToBottom(timeInSecond, attenuated);\r\n    }\r\n\r\n    /**\r\n     * 滚动到视图左部\r\n     */\r\n    public scrollToLeft(timeInSecond: number = 0, attenuated: boolean = true): void {\r\n        this.scrollView.scrollToLeft(timeInSecond, attenuated);\r\n    }\r\n\r\n    /**\r\n     * 滚动到视图右部\r\n     */\r\n    public scrollToRight(timeInSecond: number = 0, attenuated: boolean = true): void {\r\n        this.scrollView.scrollToRight(timeInSecond, attenuated);\r\n    }\r\n\r\n    /**\r\n     * 根据参数计算元素大小的接口（isFixedSize为false时必须提供）\r\n     */\r\n    public setCalcItemSize(call: (args: T) => cc.Size): void {\r\n        this._calcItemSize = call;\r\n    }\r\n\r\n    /**\r\n     * 立即更新布局\r\n     */\r\n    public forceUpdate(): void {\r\n        this.layout.forceUpdate();\r\n    }\r\n\r\n    /**\r\n     * 刷新所有激活的item\r\n     */\r\n    public refreshAllItems(): void {\r\n        this.layout.refreshAllItems();\r\n    }\r\n\r\n    /**\r\n     * 重置某个元素数据\r\n     * @param index \r\n     * @param args 元素所需参数\r\n     */\r\n    public reset(index: number, args: T): void {\r\n        if (Tool.inRange(0, this._argsArr.length - 1, index)) {\r\n            this._argsArr[index] = args;\r\n            this.layout.rearrange();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 添加元素数据到尾部\r\n     * @param args 元素所需参数\r\n     */\r\n    public push(args: T): number {\r\n        let result = this._argsArr.push(args);\r\n        this.layout.rearrange(false);\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 删除尾部元素数据\r\n     */\r\n    public pop(): T {\r\n        let result = this._argsArr.pop();\r\n        this.layout.rearrange();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 添加元素数据到头部\r\n     * @param args \r\n     */\r\n    public unshift(args: T): number {\r\n        let result = this._argsArr.unshift(args);\r\n        this.layout.rearrange();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 删除头部元素数据\r\n     */\r\n    public shift(): T {\r\n        let result = this._argsArr.shift();\r\n        this.layout.rearrange();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 插入或删除元素 用法同数组splice\r\n     */\r\n    public splice(start: number, deleteCount?: number, ...argsArr: T[]): T[] {\r\n        let result: T[];\r\n        if (deleteCount === undefined) {\r\n            result = this._argsArr.splice(start);\r\n        } else {\r\n            if (argsArr === undefined || argsArr.length === 0) {\r\n                result = this._argsArr.splice(start, deleteCount);\r\n            } else {\r\n                result = this._argsArr.splice(start, deleteCount, ...argsArr);\r\n            }\r\n        }\r\n\r\n        this.layout.rearrange();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 数据排序\r\n     * @param call \r\n     */\r\n    public sort(call: (a: T, b: T) => number): T[] {\r\n        let result = this._argsArr.sort(call);\r\n        this.layout.rearrange();\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * 数据过滤\r\n     */\r\n    public filter(call: (value: T, index: number, array: T[]) => boolean): T[] {\r\n        this._argsArr = this._argsArr.filter(call);\r\n        this.layout.rearrange();\r\n        return this._argsArr;\r\n    }\r\n}\r\n"]}