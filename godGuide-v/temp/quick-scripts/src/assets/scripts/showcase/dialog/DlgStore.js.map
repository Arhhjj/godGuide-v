{"version":3,"sources":["assets\\scripts\\showcase\\dialog\\DlgStore.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gEAA2D;AAC3D,sDAAiD;AACjD,0DAAyD;AACzD,8CAAgD;AAChD,0DAAyE;AACzE,mDAA8C;AAC9C,+CAA0C;AAEpC,IAAA,KAA8B,EAAE,CAAC,UAAU,EAAzC,OAAO,aAAA,EAAE,QAAQ,cAAA,EAAE,IAAI,UAAkB,CAAC;AAGlD;IAAsC,4BAAU;IAAhD;QAAA,qEA2CC;QAxCsB,WAAK,GAAY,IAAI,CAAA;;IAwC5C,CAAC;IAtCa,yBAAM,GAAhB;QACI,iBAAM,MAAM,WAAE,CAAC;QACf,gBAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC1B,CAAC;IAES,4BAAS,GAAnB;QACI,gBAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAC3B,CAAC;IAES,yBAAM,GAAhB;QAAA,iBAIC;QAHG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;YACpC,cAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,KAAG,KAAO,EAAE,KAAI,CAAC,IAAI,CAAC,CAAA;QACxG,CAAC,CAAC,CAAA;IACN,CAAC;IAES,6BAAU,GAApB,UAAqB,CAAC,EAAE,GAAG;QACvB,GAAG,GAAG,CAAC,GAAG,CAAA;QACV,IAAI,kBAAQ,CAAC,QAAQ,CAAC,IAAI,GAAG,GAAG,EAAE;YAC9B,eAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,CAAA;YACtE,OAAM;SACT;QACD,eAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,CAAA;QACtE,kBAAQ,CAAC,QAAQ,CAAC,IAAI,IAAI,GAAG,CAAA;QAC7B,kBAAQ,CAAC,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,CAAA;QACtC,yBAAc,CAAC,WAAW,EAAE,CAAA;QAE5B,gBAAM,CAAC,IAAI,CAAC,qBAAS,CAAC,WAAW,CAAC,CAAA;IACtC,CAAC;IAED;;OAEG;IACI,yBAAM,GAAb;QAAA,iBAIC;QAHG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAI,EAAE,KAAK;YACpC,cAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,UAAU,EAAE,YAAY,EAAE,KAAI,CAAC,IAAI,CAAC,CAAA;QAC/F,CAAC,CAAC,CAAA;IACN,CAAC;IAxCa,aAAI,GAAW,YAAM,CAAC,aAAa,GAAG,UAAU,CAAC;IAE5C;QAAlB,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;2CAAsB;IAHvB,QAAQ;QAD5B,OAAO;OACa,QAAQ,CA2C5B;IAAD,eAAC;CA3CD,AA2CC,CA3CqC,oBAAU,GA2C/C;kBA3CoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["import DialogBase from \"../../common/cmpt/base/DialogBase\";\r\nimport Layer from \"../../common/cmpt/base/Layer\";\r\nimport { EventName } from \"../../common/const/EventName\";\r\nimport { DirUrl } from \"../../common/const/Url\";\r\nimport UserInfo, { UserInfoStorge } from \"../../common/runtime/UserInfo\";\r\nimport Events from \"../../common/util/Events\";\r\nimport Tool from \"../../common/util/Tool\";\r\n\r\nconst { ccclass, property, menu } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class DlgStore extends DialogBase {\r\n    public static pUrl: string = DirUrl.PREFAB_DIALOG + \"DlgStore\";\r\n\r\n    @property(cc.Node) goods: cc.Node = null\r\n\r\n    protected onLoad() {\r\n        super.onLoad();\r\n        Events.targetOn(this);\r\n    }\r\n\r\n    protected onDestroy() {\r\n        Events.targetOff(this);\r\n    }\r\n\r\n    protected update() {\r\n        this.goods.children.forEach((item, index) => {\r\n            Tool.addParamButtonClick(item.getChildByName(\"购买\"), `DlgStore`, `clickEvent`, `${index}`, this.node)\r\n        })\r\n    }\r\n\r\n    protected clickEvent(e, arg) {\r\n        arg = +arg\r\n        if (UserInfo.instance.coin < 200) {\r\n            Layer.inst.showTip({ text: \"金币不足\", unique: true, end: cc.v2(0, 100) })\r\n            return\r\n        }\r\n        Layer.inst.showTip({ text: \"购买成功\", unique: true, end: cc.v2(0, 100) })\r\n        UserInfo.instance.coin -= 200\r\n        UserInfo.instance.propConfig[arg] += 1\r\n        UserInfoStorge.setUserInfo()\r\n\r\n        Events.emit(EventName.UPDATE_COIN)\r\n    }\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    public onOpen() {\r\n        this.goods.children.forEach((item, index) => {\r\n            Tool.removeParamButtonClick(item.getChildByName(\"购买\"), `DlgStore`, `clickEvent`, this.node)\r\n        })\r\n    }\r\n\r\n}\r\n"]}