{"version":3,"sources":["assets\\scripts\\showcase\\dialog\\DlgMultiTexture.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import DialogBase from \"../../common/cmpt/base/DialogBase\";\r\nimport MultiSprite from \"../../common/cmpt/ui/multiTexture/MultiSprite\";\r\nimport { MultiTextureManager } from \"../../common/cmpt/ui/multiTexture/MultiTextureManager\";\r\nimport { DirUrl, ResUrl } from \"../../common/const/Url\";\r\nimport Res from \"../../common/util/Res\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n// 原生平台默认关闭动态合图，在此为了测试强制开启\r\nif (CC_NATIVERENDERER) {\r\n    cc.game.once(cc.game.EVENT_ENGINE_INITED, () => {\r\n        cc.macro.CLEANUP_IMAGE_CACHE = false;\r\n        cc.dynamicAtlasManager.enabled = true;\r\n    });\r\n}\r\n\r\n@ccclass\r\nexport default class DlgMultiTexture extends DialogBase {\r\n    public static pUrl: string = DirUrl.PREFAB_DIALOG + \"DlgMultiTexture\";\r\n\r\n    @property(cc.Node)\r\n    item1: cc.Node = null;\r\n    @property(cc.Node)\r\n    item2: cc.Node = null;\r\n    @property(cc.Node)\r\n    item3: cc.Node = null;\r\n\r\n    /**\r\n     * @override\r\n     */\r\n    public async onOpen() {\r\n        let arr = [ResUrl.ATLAS.EN, ResUrl.ATLAS.ZH];\r\n\r\n        // idx为0的纹理：Cocos自动图集纹理\r\n        let atlas = await Res.load<cc.SpriteAtlas>(arr[0], cc.SpriteAtlas);\r\n        MultiTextureManager.setTexture(0, atlas.getTexture());\r\n\r\n        this.createNodes();\r\n\r\n        // idx为1的纹理：Cocos自动图集纹理\r\n        atlas = await Res.load<cc.SpriteAtlas>(arr[1], cc.SpriteAtlas);\r\n        MultiTextureManager.setTexture(1, atlas.getTexture());\r\n\r\n        this.createNodes();\r\n\r\n        // idx为2的纹理：动态合图纹理\r\n        let lastNode = this.node.getChildByName(\"bg\").children[this.node.getChildByName(\"bg\").childrenCount - 1];\r\n        let sf = lastNode.getComponent(MultiSprite).spriteFrame;\r\n        if (sf[\"_original\"]) {\r\n            // 此纹理已进行动态合图\r\n            MultiTextureManager.setTexture(2, sf.getTexture());\r\n        }\r\n\r\n        this.createNodes();\r\n    }\r\n\r\n    /**\r\n     * 生成3个使用不同图集纹理的节点\r\n     */\r\n    private createNodes() {\r\n        let node1 = Res.instantiate(this.item1);\r\n        this.node.getChildByName(\"bg\").addChild(node1);\r\n        node1.setPosition(0, 0);\r\n        let node2 = Res.instantiate(this.item2);\r\n        this.node.getChildByName(\"bg\").addChild(node2);\r\n        node2.setPosition(0, 0);\r\n        let node3 = Res.instantiate(this.item3);\r\n        this.node.getChildByName(\"bg\").addChild(node3);\r\n        node3.setPosition(0, 0);\r\n    }\r\n}\r\n"]}